

@RequestMapping(value="/to_list",produces="text/html")

SpringWebContext

URL

缓存更新模式

spring.resouces 

@NeedLogin拦截器

# CDN优化

CDN就可以理解为分布在每个县城的火车票代售点，用户在浏览网站的时候，CDN会选择一个离用户最近的CDN边缘节点来响应用户的请求，这样海南移动用户的请求就不会千里迢迢跑到北京电信机房的服务器（假设源站部署在北京电信机房）上了。

浏览器向服务器请求数据，如果中间加上一层CDN，那么用户浏览器与服务器的交互如下：

![这里写图片描述](https://mccdn.qcloud.com/img5680ff0b3dfc4.png)

客户端浏览器先检查本地缓存是否过期，如果过期，则向CDN边缘节点发起请求，CDN边缘节点会检测用户请求数据的缓存是否过期，如果没有过期，则直接响应用户请求，此时一个完成http请求结束；如果数据已经过期，那么CDN还需要向源站发出回源请求（back to the source request）,来拉取最新的数据。

**CDN的典型拓扑图：**

![这里写图片描述](https://mccdn.qcloud.com/img5680ff38c14d6.png)

CDN 的分流作用： 
1、减少了用户的访问延时， 
2、也减少了源站的负载。

但其缺点也很明显：当网站更新时，如果CDN节点上数据没有及时更新，即便用户再浏览器使用 Ctrl +F5/command+shift+r 的方式使浏览器端的缓存失效，也会因为 CDN 边缘节点没有同步最新数据而导致用户访问异常。

## CDN 缓存策略

CDN 边缘节点缓存策略因服务商不同而不同，但一般都会遵循http标准协议，通过 http 响应头中的 Cache-control: max-age 的字段来设置 CDN 边缘节点数据缓存时间。

CDN 缓存时间会对“回源率”产生直接的影响。

- 若CDN缓存时间较短，CDN 边缘节点上的数据会经常失效，导致频繁回源，增加了源站的负载，同时也增大的访问延时；
- 若CDN缓存时间太长，会带来数据更新时间慢的问题。开发者需要增对特定的业务，来做特定的数据缓存时间管理。

## CDN 缓存刷新

CDN边缘节点对开发者是透明的，相比于浏览器Ctrl+F5的强制刷新来使浏览器本地缓存失效，开发者可以通过CDN服务商提供的“刷新缓存”接口来达到清理CDN边缘节点缓存的目的。这样开发者在更新数据后，可以使用“刷新缓存”功能来强制CDN节点上的数据缓存过期，保证客户端在访问时，拉取到最新的数据。