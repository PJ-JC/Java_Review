# 面试题

## 1. 说说三大范式

第一范式: **每个列都不可以再拆分**. 第二范式: 非主键列完全依赖于主键,而不能是依赖于主键的一部分. 第三范式: 非主键列只依赖于主键,不依赖于其他非主键.

在设计数据库结构的时候,要尽量遵守三范式,如果不遵守,必须有足够的理由.比如性能. 事实上我们经常会为了性能而妥协数据库的设计.

作者：呼延十链接：https://juejin.im/post/5d351303f265da1bd30596f9来源：掘金著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

# **第一范式**

1. 概念：列不可分。每一列都是不可分割的基本数据项。
2. 例子：假设我们有一个学生表，字段包括：id,name,age,contact，如下：



![img](https://user-gold-cdn.xitu.io/2019/6/26/16b915dc56615eec?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)



当我们需要根据QQ来查询学生的时候，就查询不出，所以以上的设计就不符合1NF。我们可以将contact字段拆分为phone和QQ，如下：



![img](https://user-gold-cdn.xitu.io/2019/6/26/16b915dcf2c8008f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)



这样就满足1NF了。

# **第二范式**   

1. 概念：1NF的基础上面，非主属性完全依赖于主关键字。
2. 例子：学生表：(学号, 姓名, 年龄, 课程名称, 成绩, 学分) ，从字段可以看出，此表联合主键是（学号，课程名称）。

存在如下决定关系：

1. (学号, 课程名称) → (姓名, 年龄, 成绩, 学分)
2. (课程名称) → (学分)
3. (学号) → (姓名, 年龄)

其中，姓名、年龄、学分是部分依赖于主键的，而成绩是完全依赖于主键的，存在部分依赖关系，所以不满足第二范式。

这会造成如下问题：

(1) 数据冗余：

 同一门课程由n个学生选修，"学分"就重复n-1次；同一个学生选修了m门课程，姓名和年龄就重复了m-1次。

  (2) 更新异常：

 若调整了某门课程的学分，数据表中所有行的"学分"值都要更新，否则会出现同一门课程学分不同的情况。

  (3) 插入异常：

   假设要开设一门新的课程，暂时还没有人选修。这样，由于还没有"学号"关键字，课程名称和学分也无法记录入数据 库。

​     (4) 删除异常：

  假设一批学生已经完成课程的选修，这些选修记录就应该从数据库表中删除。但是，与此同时，课程名称和学分信息也被删除了。很显然，这也会导致插入异常。

问题就在于存在非主属性对主键的部分依赖。

解决办法：把原表(学号, 姓名, 年龄, 课程名称, 成绩, 学分)分成三个表：

- 学生：Student(学号, 姓名, 年龄)；
- 课程：Course(课程名称, 学分)；
- 选课关系：SelectCourse(学号, 课程名称, 成绩)。

# **第三范式**

1. 概念：2NF的基础上，属性不依赖于其它非主属性 , 消除传递依赖。第三范式又可描述为：表中不存在可以确定其他非关键字的非关键字段。
2. 例子：学生表：(学号, 姓名, 年龄, 所在学院, 学院地点, 学院电话)，主键必然是学号。

由于主键是单一属性，所以非主属性完全依赖于主键，所以必然满足第二范式。但是存在如下传递依赖：

(学号) → (所在学院) → (学院地点, 学院电话)，

学院地点 和 学院电话传递依赖于学号，而学院地点和学院电话都是非关键字段，即表中出现了“某一非关键字段可以确定出其它非关键字段”的情况，于是违反了第三范式。          

解决办法：

把原表分成两个表：

- 学生：(学号, 姓名, 年龄, 所在学院)；
- 学院：(学院, 地点, 电话)。


作者：码咖链接：https://juejin.im/post/5d12c825e51d4510664d1706来源：掘金著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。