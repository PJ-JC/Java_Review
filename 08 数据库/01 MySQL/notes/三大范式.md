# 面试题

## 1. 说说三大范式

第一范式: **每个列都不可以再拆分**。强调的是**原子性**。

第二范式: 首先满足1NF,**非主键列完全依赖于主键**,而不能是依赖于主键的一部分。

第三范式: 首先满足2NF,**非主键列直接依赖于主键,不是通过传递关系依赖**。即不能存在：非主键列 A 依赖于非主键列 B，

非主键列 B 依赖于主键的情况。

## 2. 范式的存在有什么好处

范式可以**避免数据冗余，减少数据库的空间，减轻维护数据完整性的麻烦。**

# 反范式

范式再给我们带来的上面的好处时，同时也伴随着一些不好的地方：按照范式的规范设计出来的表，等级越高的范式设计出来的表越多。如第一范式可能设计出来的表可能只有一张表而已，再按照第二范式去设计这张表时就可能出来两张或更多张表，如果再按第三范式或更高的范式去设计这张表会出现更多比第二范式多的表。表的数量越多，当我们去查询一些数据，必然要去多表中去查询数据，这样查询的时间要比在一张表中查询中所用的时间要高很多。

也就是说我们所用的范式越高，对数据操作的性能越低。所以我们在利用范式设计表的时候，要根据具体的需求再去权衡是否使用更高范式去设计表。在一般的项目中，我们用的最多也就是第三范式，第三范式也就可以满足我们的项目需求，性能好而且方便管理数据；

当我们的业务所涉及的表非常多，经常会有多表发生关系，并且我们对表的操作要时间上要尽量的快，这时可以考虑我们使用“反范式”。反范式，故名思义，跟范式所要求的正好相反，在反范式的设计模式，我们可以允许适当的数据的冗余，用这个冗余去取操作数据时间的缩短。也就是用空间来换取时间,把数据冗余在多个表中，当查询时可以减少或者是避免表之间的关联。
原文链接：https://blog.csdn.net/traceofsun/article/details/6411344

# **第一范式**

1. 概念：列不可分。每一列都是不可分割的基本数据项。
2. 例子：假设我们有一个学生表，字段包括：id,name,age,contact，如下：

![img](https://user-gold-cdn.xitu.io/2019/6/26/16b915dc56615eec?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

当我们需要根据QQ来查询学生的时候，就查询不出，所以以上的设计就不符合1NF。我们可以将contact字段拆分为phone和QQ，如下：

![img](https://user-gold-cdn.xitu.io/2019/6/26/16b915dcf2c8008f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

这样就满足1NF了。

# **第二范式**   

1. 概念：1NF的基础上面，非主属性完全依赖于主关键字。
2. 例子：学生表：(学号, 姓名, 年龄, 课程名称, 成绩, 学分) ，从字段可以看出，此表联合主键是（学号，课程名称）。

存在如下决定关系：

1. (学号, 课程名称) → (姓名, 年龄, 成绩, 学分)
2. (课程名称) → (学分)
3. (学号) → (姓名, 年龄)

其中，姓名、年龄、学分是部分依赖于主键的，而成绩是完全依赖于主键的，存在部分依赖关系，所以不满足第二范式。

这会造成如下问题：

(1) 数据冗余：

 同一门课程由n个学生选修，"学分"就重复n-1次；同一个学生选修了m门课程，姓名和年龄就重复了m-1次。

  (2) 更新异常：

 若调整了某门课程的学分，数据表中所有行的"学分"值都要更新，否则会出现同一门课程学分不同的情况。

  (3) 插入异常：

   假设要开设一门新的课程，暂时还没有人选修。这样，由于还没有"学号"关键字，课程名称和学分也无法记录入数据 库。

​     (4) 删除异常：

  假设一批学生已经完成课程的选修，这些选修记录就应该从数据库表中删除。但是，与此同时，课程名称和学分信息也被删除了。很显然，这也会导致插入异常。

问题就在于存在非主属性对主键的部分依赖。

解决办法：把原表(学号, 姓名, 年龄, 课程名称, 成绩, 学分)分成三个表：

- 学生：Student(学号, 姓名, 年龄)；
- 课程：Course(课程名称, 学分)；
- 选课关系：SelectCourse(学号, 课程名称, 成绩)。

# **第三范式**

1. 概念：2NF的基础上，属性不依赖于其它非主属性 , 消除传递依赖。第三范式又可描述为：表中不存在可以确定其他非关键字的非关键字段。
2. 例子：学生表：(学号, 姓名, 年龄, 所在学院, 学院地点, 学院电话)，主键必然是学号。

由于主键是单一属性，所以非主属性完全依赖于主键，所以必然满足第二范式。但是存在如下传递依赖：

(学号) → (所在学院) → (学院地点, 学院电话)，

学院地点 和 学院电话传递依赖于学号，而学院地点和学院电话都是非关键字段，即表中出现了“某一非关键字段可以确定出其它非关键字段”的情况，于是违反了第三范式。          

解决办法：

把原表分成两个表：

- 学生：(学号, 姓名, 年龄, 所在学院)；
- 学院：(学院, 地点, 电话)。


作者：码咖链接：https://juejin.im/post/5d12c825e51d4510664d1706