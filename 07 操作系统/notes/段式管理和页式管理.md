# 页式和段式存储管理

  在前面的几种存储管理方法中，为进程分配的空间是连续的，使用的地址都是物理地址。如果允许将一个进程分散到许多不连续的空间，就可以避免**内存紧缩，减少碎片**。基于这一思想，通过引入进程的逻辑地址，把进程地址空间与实际存储空间分离，增加存储管理的灵活性。地址空间和存储空间两个基本概念的定义如下：

地址空间：将源程序经过编译后得到的目标程序，存在于它所限定的地址范围内，这个范围称为地址空间。地址空间是逻辑地址的集合。

存储空间：指主存中一系列存储信息的物理单元的集合，这些单元的编号称为物理地址存储空间是物理地址的集合。

根据分配时所采用的基本单位不同，可将离散分配的管理方式分为以下三种：
**页式存储管理、段式存储管理和段页式存储管理。**其中段页式存储管理是前两种结合的产物。

# 页式存储管理

## 基本原理

**将程序的逻辑地址空间划分为固定大小的页(page)，而物理内存划分为同样大小的页框(page frame)。**

页式管理方式的优点是：

  1）没有外碎片，每个内碎片不超过页大比前面所讨论的几种管理方式的最大进步是，

  2）一个程序不必连续存放。

  3）便于改变程序占用空间的大小(主要指随着程序运行，动态生成的数据增多，所要求的地址空间相应增长)。

缺点是：要求程序全部装入内存，没有足够的内存，程序就不能执行。

# 段式存储管理

## 基本原理

 在段式存储管理中，**将程序的地址空间划分为若干个段(segment)，这样每个进程有一个二维的地址空间。**在前面所介绍的动态分区分配方式中，系统为整个进程分配一个连续的内存空间。而在段式存储管理系统中，则为每个段分配一个连续的分区，而进程中的各个段可以不连续地存放在内存的不同分区中。程序加载时，操作系统为所有段分配其所需内存，这些段不必连续，物理内存的管理采用动态分区的管理方法。

 在为某个段分配物理内存时，可以采用首先适配法、下次适配法、最佳适配法等方法。

 在回收某个段所占用的空间时，要注意将收回的空间与其相邻的空间合并。

段式存储管理的优点是：没有内碎片，外碎片可以通过内存紧缩来消除；便于实现内存共享。缺点与页式存储管理的缺点相同，进程必须全部装入内存。

# 页式和段式管理的区别

页式和段式系统有许多相似之处。比如，两者都采用离散分配方式，且都通过地址映射机构来实现地址变换。但概念上两者也有很多区别，主要表现在：

  1)、需求：是信息的物理单位，分页是为了实现离散分配方式，以减少内存的碎片，提高内存的利用率。或者说，分页仅仅是由于系统管理的需要，而不是用户的需要。段是信息的逻辑单位，它含有一组其意义相对完整的信息。分段的目的是为了更好地满足用户的需要。

  一条指令或一个操作数可能会跨越两个页的分界处，而不会跨越两个段的分界处。
  2)、大小：页大小固定且由系统决定，把逻辑地址划分为页号和页内地址两部分，是由机器硬件实现的。段的长度不固定，且决定于用户所编写的程序，通常由编译系统在对源程序进行编译时根据信息的性质来划分。

  3)、逻辑地址表示：页式系统地址空间是一维的，即单一的线性地址空间，程序员只需利用一个标识符，即可表示一个地址。分段的作业地址空间是二维的，程序员在标识一个地址时，既需给出段名，又需给出段内地址。

  4)、比页大，因而段表比页表短，可以缩短查找时间，提高访问速度。

# [分段](https://cyc2018.github.io/CS-Notes/#/notes/计算机操作系统 - 内存管理?id=分段)

虚拟内存采用的是分页技术，也就是将地址空间划分成固定大小的页，每一页再与内存进行映射。

下图为一个编译器在编译过程中建立的多个表，有 4 个表是动态增长的，如果使用分页系统的一维地址空间，动态增长的特点会导致覆盖问题的出现。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/22de0538-7c6e-4365-bd3b-8ce3c5900216.png)

分段的做法是把每个表分成段，一个段构成一个独立的地址空间。每个段的长度可以不同，并且可以动态增长。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/e0900bb2-220a-43b7-9aa9-1d5cd55ff56e.png)

# [段页式](https://cyc2018.github.io/CS-Notes/#/notes/计算机操作系统 - 内存管理?id=段页式)

程序的地址空间划分成多个拥有独立地址空间的段，每个段上的地址空间划分成大小相同的页。这样既拥有分段系统的共享和保护，又拥有分页系统的虚拟内存功能。

# [分页与分段的比较](https://cyc2018.github.io/CS-Notes/#/notes/计算机操作系统 - 内存管理?id=分页与分段的比较)

- 对程序员的透明性：分页**透明**，但是分段需要程序员**显式划分每个段**。
- 地址空间的维度：分页是**一维地址空间**，分段是**二维的**。
- 大小是否可以改变：页的大小**不可变**，段的大小可以**动态改变**。
- 出现的原因：分页主要用于实现虚拟内存，从而获得更大的地址空间；分段主要是为了使程序和数据可以被划分为逻辑上独立的地址空间并且有助于共享和保护。